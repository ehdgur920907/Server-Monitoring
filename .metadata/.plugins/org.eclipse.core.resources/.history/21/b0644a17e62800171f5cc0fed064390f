package com.information.get;

import org.hyperic.sigar.Mem;
import org.hyperic.sigar.Sigar;

import com.information.model.Memory;

public class GetMemory implements Get {
	@Override
	public Memory execute() {
		Sigar sigar = new Sigar();
		Memory memory = new Memory();
		Double totalMemory, usedMemory, freeMemory;

		Mem mem = null;

		try {
			mem = sigar.getMem();
			totalMemory = (double)Math.round((double) mem.getTotal() / 1000000000);
			usedMemory = (double)Math.round((double) mem.getUsed() / 1000000000);
			freeMemory = (double)Math.round((double) mem.getFree() / 1000000000);

			System.out.println(totalMemory);
			
			totalMemory = Double.parseDouble(String.format("%.4f", totalMemory));
			usedMemory = Double.parseDouble(String.format("%.4f", usedMemory));
			freeMemory = Double.parseDouble(String.format("%.4f", freeMemory));
			
			System.out.println(totalMemory);
			
			/* KB ->Â GB */
			memory.setFreeMemory(String.valueOf(freeMemory));
			memory.setUsedMemory(String.valueOf(usedMemory));
			memory.setTotalMemory(String.valueOf(totalMemory));
		} catch (Exception e) {
			e.printStackTrace();
		}
		return memory;
	}
}
